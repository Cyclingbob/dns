define("app/services/applicationListService",["angular","cjt/io/api","cjt/io/uapi-request","cjt/io/uapi"],function(e,t,r){var n=e.module("App");n.factory("applicationListService",["$q",function(e){return{fetchApplicationList:function(){var n=e.defer(),a=new r.Class;return a.initialize("Branding","get_available_applications"),t.promise(a.getRunArguments()).done(function(e){e=e.parsedResponse,e.status?n.resolve(e.data):n.reject(e.error)}),n.promise},setCollapsedGroupsList:function(n){var a=e.defer(),i=new r.Class;return i.initialize("NVData","set"),i.addArgument("names","xmainrollstatus"),i.addArgument("xmainrollstatus",n),t.promise(i.getRunArguments()).done(function(e){e=e.parsedResponse,e.status?a.resolve(e.data):a.reject(e.error)}),a.promise},setGroupsOrder:function(n){var a=e.defer(),i=new r.Class;return i.initialize("NVData","set"),i.addArgument("names","xmaingroupsorder"),i.addArgument("xmaingroupsorder",n),t.promise(i.getRunArguments()).done(function(e){e=e.parsedResponse,e.status?a.resolve(e.data):a.reject(e.error)}),a.promise}}}])}),define("app/directives/draggableDirective",["angular"],function(e){var t;try{t=e.module("App")}catch(r){t=e.module("App",[])}t.directive("draggable",[function(){return{restrict:"A",scope:{drag:"&"},link:function(t,r){var n=r[0];n.draggable=!0,n.addEventListener("dragstart",function(r){r.dataTransfer.effectAllowed="move",r.dataTransfer.setData("text",this.id),e.element(this).addClass("drag");var n=this;return t.$apply(function(t){var r=t.drag();e.isDefined(r)&&r(n.id)}),!1},!1),n.addEventListener("dragend",function(){return e.element(this).removeClass("drag"),!1},!1)}}}])}),define("app/directives/dropDirective",["angular"],function(e){var t;try{t=e.module("App")}catch(r){t=e.module("App",[])}t.directive("dropArea",[function(){return{scope:{drop:"&"},link:function(t,r){var n=r[0];n.addEventListener("dragover",function(t){return t.dataTransfer.dropEffect="move",t.preventDefault&&t.preventDefault(),e.element(this).addClass("drag-over"),!1},!1),n.addEventListener("dragenter",function(){return e.element(this).addClass("drag-over"),!1},!1),n.addEventListener("dragleave",function(){return e.element(this).removeClass("drag-over"),!1},!1),n.addEventListener("drop",function(r){r.stopPropagation&&r.stopPropagation(),r.preventDefault&&r.preventDefault(),e.element(this).removeClass("drag-over");var n=this,a=document.getElementById(r.dataTransfer.getData("text"));return t.$apply(function(t){var r=t.drop();e.isDefined(r)&&r(a.id,n.id)}),!1},!1)}}}])}),define("app/views/applicationListController",["angular","lodash","uiBootstrap","app/services/applicationListService","app/directives/draggableDirective","app/directives/dropDirective"],function(e,t){var r=e.module("App"),n=r.controller("applicationListController",["$scope","applicationListService",function(r,n){r.applicationList=PAGE.appGroups,r.collapsedGroupsList=PAGE.collapsedGroups,e.element(document).ready(function(){if("undefined"==typeof PAGE.appGroups){var e=n.fetchApplicationList();e.status&&(r.applicationList=e.groups)}}),r.clearSearch=function(e){27===e.keyCode&&(r.searchText="")},r.searchCache={},r.searchGroup=function(e){if(!r.searchText)return 1;r.searchCache[r.searchText]||(r.searchCache[r.searchText]=new RegExp(r.searchText,"i"));for(var t=r.searchCache[r.searchText],n=!1,a=e.items,i=0,o=a.length;o>i;i++)if(n=t.test(a[i].searchtext))return n},r.searchItem=function(e){if(!r.searchText)return 1;r.searchCache[r.searchText]||(r.searchCache[r.searchText]=new RegExp(r.searchText,"i"));var t=r.searchCache[r.searchText];return t.test(e.searchtext)},r.isCollapsedGroup=function(e){return e+="=0",-1!==r.collapsedGroupsList.indexOf(e)&&!r.searchText},r.toggleGroup=function(e){e+="=0";var t=r.collapsedGroupsList.indexOf(e);-1===t?r.collapsedGroupsList.push(e):r.collapsedGroupsList.splice(t,1);var a=r.collapsedGroupsList.join("|");n.setCollapsedGroupsList(a)},r.handleDrag=function(n){var a=t.findIndex(r.applicationList,function(e){return e.group===n.replace("-group","")}),i="#top-drop-area";a>0&&(i="#"+r.applicationList[a-1].group+"-drop-area");var o=e.element(document.querySelector(i));o.addClass("drag-hidden")},r.handleDrop=function(a,i){var o=t.findIndex(r.applicationList,function(e){return e.group===a.replace("-group","")}),s=r.applicationList[o],c=t.findIndex(r.applicationList,function(e){return e.group===i.replace("-drop-area","")});o>c&&(c+=1),r.applicationList.splice(o,1),r.applicationList.splice(c,0,s);var u=t.map(r.applicationList,"group").join("|");n.setGroupsOrder(u);var p=e.element(document.querySelector(".drag-hidden"));p.removeClass("drag-hidden")}}]);return n}),define("app/services/statisticsService",["angular"],function(e){var t=e.module("App");t.factory("statisticsService",["$q","$http",function(e,t){return{fetchExtendedStats:function(){var r=e.defer();return t.get("home/views/statistics.html.tt?secpolicy_ui=no").success(function(e){r.resolve(e)}).error(function(e){r.reject(e)}),r.promise}}}])}),define("app/views/statisticsController",["angular","app/services/statisticsService","cjt/directives/spinnerDirective","cjt/decorators/growlDecorator"],function(e){var t=e.module("App"),r=t.controller("statisticsController",["$scope","spinnerAPI","statisticsService","growl","$timeout",function(e,t,r,n,a){t.start("loadingStatsSpinner"),a(function(){r.fetchExtendedStats().then(function(t){e.statistics=t},function(e){n.error(e)}).finally(function(){t.stop("loadingStatsSpinner")})}),e.getStatStatus=function(e){return e>=80?"danger":e>=60?"warning":e>=40?"info":e>=0?"success":void 0}}]);return r}),define("app/services/themesService",["angular","cjt/io/api","cjt/io/uapi-request","cjt/io/uapi"],function(e,t,r){var n=e.module("App");n.factory("themesService",["$q",function(e){return{getAvailableThemes:function(){var n=e.defer(),a=new r.Class;return a.initialize("Themes","list",{show_mail_themes:0}),t.promise(a.getRunArguments()).done(function(e){e=e.parsedResponse,e.status?n.resolve(e.data):n.reject(e.error)}),n.promise},setTheme:function(n){var a=e.defer(),i=new r.Class;return i.initialize("Themes","update",{theme:n}),t.promise(i.getRunArguments()).done(function(e){e=e.parsedResponse,e.status?a.resolve(e.data):a.reject(e.error)}),a.promise}}}])}),define("app/views/themesController",["angular","jquery","app/services/themesService","cjt/decorators/growlDecorator","jquery-chosen","angular-chosen"],function(e){var t=e.module("App"),r=t.controller("themesController",["$scope","$window","themesService","growl","$timeout",function(e,t,r,n,a){e.isRTL=PAGE.isRTL||!1,e.updated=!0,a(function(){r.getAvailableThemes().then(function(t){t&&t.length>0&&(e.themes=t,PAGE.currentTheme&&(e.selectedTheme=PAGE.currentTheme))},function(e){n.error(e)}).finally(function(){e.updated=!0})}),e.themeChanged=function(){""!==e.selectedTheme&&(r.setTheme(e.selectedTheme),PAGE&&PAGE.securityToken&&PAGE.userName&&(t.location.href=PAGE.securityToken+"/xfercpanel/"+PAGE.userName+"?theme="+e.selectedTheme))}}]);return r}),define("app/services/accountsService",["angular","cjt/io/api","cjt/io/uapi-request","cjt/io/uapi"],function(e,t,r){var n=e.module("App");n.factory("accountsService",["$q",function(e){return{getAvailableAccounts:function(n){var a=e.defer(),i=new r.Class;return i.initialize("Resellers","list_accounts"),t.promise(i.getRunArguments()).done(function(e){if(e=e.parsedResponse,e.status){n=n||!1;for(var t,r=0,i=e.data.length;i>r;r++)t=e.data[r],t.accountLabel=n?"â€Ž("+t.domain+") "+t.user:t.user+" ("+t.domain+")";a.resolve(e.data)}else a.reject(e.error)}),a.promise}}}])}),define("app/views/accountsController",["angular","lodash","jquery","app/services/accountsService","cjt/decorators/growlDecorator","jquery-chosen","angular-chosen"],function(e,t){var r=e.module("App"),n=r.controller("accountsController",["$scope","$window","accountsService","growl","$timeout",function(e,r,n,a,i){e.isRTL=PAGE.isRTL||!1,e.updated=!0,i(function(){n.getAvailableAccounts(e.isRTL).then(function(r){r&&r.length>=1&&(e.accounts=r,PAGE.userName&&(e.selectedAccount=t.find(r,["user",PAGE.userName])))},function(e){a.error(e)}).finally(function(){e.updated=!0})}),e.accountChanged=function(){e.selectedAccount&&PAGE&&PAGE.securityToken&&(r.location.href=PAGE.securityToken+"/xfercpanel/"+e.selectedAccount.user)}}]);return n}),define("app/index",["angular","ngSanitize","cjt/core","cjt/modules","uiBootstrap","jquery-chosen","angular-chosen"],function(e,t,r){return function(){e.module("App",["ngSanitize","ui.bootstrap","cjt2.cpanel","angular-growl","localytics.directives"]);var t=require(["app/views/applicationListController","app/views/statisticsController","app/views/themesController","app/views/accountsController"],function(){var t=e.module("App");t.config(["growlProvider",function(e){e.globalTimeToLive({success:5e3,warning:5e3,info:5e3,error:-1}),e.globalDisableCountDown(!0)}]),t.init=function(){var r=e.element("#content");return null!==r[0]&&e.bootstrap(r[0],["App"]),t},t.config(["$compileProvider",function(e){r.config.debug||e.debugInfoEnabled(!1)}]),t.config(["$httpProvider",function(e){e.useApplyAsync(!0)}]),t.init()});return t}});